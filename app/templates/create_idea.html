{% extends "base.html" %}

{% block title %}–°–æ–∑–¥–∞—Ç—å –∏–¥–µ—é - ReqImple{% endblock %}

{% block styles %}
<style>
    .idea-form {
        max-width: 800px;
        margin: 0 auto;
        background: white;
        padding: 30px;
        border-radius: 10px;
        box-shadow: 0 2px 15px rgba(0,0,0,0.1);
    }

    .form-header {
        border-bottom: 2px solid #f0f0f0;
        padding-bottom: 20px;
        margin-bottom: 30px;
    }

    .form-footer {
        border-top: 2px solid #f0f0f0;
        padding-top: 20px;
        margin-top: 30px;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .char-counter {
        font-size: 12px;
        color: #666;
        text-align: right;
        margin-top: 5px;
    }

    .form-label {
        font-weight: 600;
        margin-bottom: 8px;
        color: #333;
    }

    textarea {
        resize: vertical;
        min-height: 150px;
    }

    .help-text {
        font-size: 14px;
        color: #666;
        margin-top: 5px;
    }
</style>
{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="idea-form">
        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
        <div class="form-header">
            <h1 class="mb-3">üí° –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –∏–¥–µ—é</h1>
            <p class="text-muted">
                –ü–æ–¥–µ–ª–∏—Ç–µ—Å—å —Å–≤–æ–µ–π –∏–¥–µ–µ–π —Å —Å–æ–æ–±—â–µ—Å—Ç–≤–æ–º. –ß–µ–º –ø–æ–¥—Ä–æ–±–Ω–µ–µ –æ–ø–∏—Å–∞–Ω–∏–µ, —Ç–µ–º –±–æ–ª—å—à–µ —à–∞–Ω—Å–æ–≤ –Ω–∞–π—Ç–∏ –µ–¥–∏–Ω–æ–º—ã—à–ª–µ–Ω–Ω–∏–∫–æ–≤!
            </p>
        </div>

        <!-- –°–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö/—É—Å–ø–µ—Ö–µ -->
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="alert alert-{{ category if category != 'message' else 'info' }} alert-dismissible fade show">
                        {{ message }}
                        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                    </div>
                {% endfor %}
            {% endif %}
        {% endwith %}

        <!-- –§–æ—Ä–º–∞ -->
        <form method="POST" action="{{ url_for('main.create_idea') }}" id="ideaForm">
            {{ form.hidden_tag() }}

            <!-- –ü–æ–ª–µ: –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
            <div class="mb-4">
                <label class="form-label">
                    <i class="bi bi-type-h1 me-2"></i>–ó–∞–≥–æ–ª–æ–≤–æ–∫ –∏–¥–µ–∏
                </label>
                {{ form.title(id="title", class="form-control form-control-lg", placeholder="...") }}
                <div class="help-text">
                    –ë—É–¥—å—Ç–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã. –ü—Ä–∏–º–µ—Ä: "–ú–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —É—á–µ—Ç–∞ –ª–∏—á–Ω—ã—Ö —Ñ–∏–Ω–∞–Ω—Å–æ–≤"
                </div>
                {% for error in form.title.errors %}
                    <div class="text-danger small mt-1">{{ error }}</div>
                {% endfor %}
                <div class="char-counter">
                    <span id="titleCounter">0</span>/200 —Å–∏–º–≤–æ–ª–æ–≤
                </div>
            </div>

            <!-- –ü–æ–ª–µ: –û–ø–∏—Å–∞–Ω–∏–µ -->
            <div class="mb-4">
                <label class="form-label">
                    <i class="bi bi-text-paragraph me-2"></i>–ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ
                </label>
                {{ form.description(class="form-control", placeholder="–û–ø–∏—à–∏—Ç–µ –≤–∞—à—É –∏–¥–µ—é –ø–æ–¥—Ä–æ–±–Ω–æ...", rows="8") }}
                <div class="help-text">
                    –†–∞—Å—Å–∫–∞–∂–∏—Ç–µ:
                    <ul class="mb-0">
                        <li>–í —á–µ–º —Å—É—Ç—å –∏–¥–µ–∏?</li>
                        <li>–ö–∞–∫—É—é –ø—Ä–æ–±–ª–µ–º—É –æ–Ω–∞ —Ä–µ—à–∞–µ—Ç?</li>
                        <li>–ö—Ç–æ —Ü–µ–ª–µ–≤–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è?</li>
                        <li>–ö–∞–∫–∏–µ –µ—Å—Ç—å –∞–Ω–∞–ª–æ–≥–∏?</li>
                    </ul>
                </div>
                {% for error in form.description.errors %}
                    <div class="text-danger small mt-1">{{ error }}</div>
                {% endfor %}
                <div class="char-counter">
                    <span id="descCounter">0</span> —Å–∏–º–≤–æ–ª–æ–≤ (–º–∏–Ω–∏–º—É–º 50)
                </div>
            </div>

            <!-- –ü–æ–¥—Å–∫–∞–∑–∫–∏ –¥–ª—è —Ö–æ—Ä–æ—à–µ–≥–æ –æ–ø–∏—Å–∞–Ω–∏—è -->
            <div class="alert alert-info mb-4">
                <h6><i class="bi bi-lightbulb me-2"></i>–°–æ–≤–µ—Ç—ã –¥–ª—è —Ö–æ—Ä–æ—à–µ–≥–æ –æ–ø–∏—Å–∞–Ω–∏—è:</h6>
                <ul class="mb-0">
                    <li>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Markdown –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</li>
                    <li>–î–æ–±–∞–≤—å—Ç–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã</li>
                    <li>–û–ø–∏—à–∏—Ç–µ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏</li>
                    <li>–£–∫–∞–∂–∏—Ç–µ, –∫–∞–∫–∞—è –ø–æ–º–æ—â—å –Ω—É–∂–Ω–∞ (–¥–∏–∑–∞–π–Ω, –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)</li>
                </ul>
            </div>

            <!-- –ö–Ω–æ–ø–∫–∏ -->
            <div class="form-footer">
                <div>
                    <a href="{{ url_for('main.index') }}" class="btn btn-outline-secondary">
                        <i class="bi bi-arrow-left me-2"></i>–û—Ç–º–µ–Ω–∞
                    </a>
                </div>
                <div>
                    <button type="submit" class="btn btn-primary btn-lg">
                        <i class="bi bi-rocket-takeoff me-2"></i>–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –∏–¥–µ—é
                    </button>
                </div>
            </div>
        </form>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    // –°—á–µ—Ç—á–∏–∫–∏ —Å–∏–º–≤–æ–ª–æ–≤
    document.addEventListener('DOMContentLoaded', function() {
        const titleInput = document.querySelector('#title');
        const descInput = document.querySelector('#description');
        const titleCounter = document.querySelector('#titleCounter');
        const descCounter = document.querySelector('#descCounter');

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—á–µ—Ç—á–∏–∫–æ–≤
        function updateCounters() {
            if (titleInput && titleCounter) {
                titleCounter.textContent = titleInput.value.length;
            }
            if (descInput && descCounter) {
                descCounter.textContent = descInput.value.length;
            }
        }

        // –°–ª—É—à–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è
        if (titleInput) {
            titleInput.addEventListener('input', updateCounters);
        }
        if (descInput) {
            descInput.addEventListener('input', updateCounters);
        }

        // –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
        updateCounters();

        // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –¥–≤–æ–π–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ä–º—ã
        const form = document.querySelector('#ideaForm');
        if (form) {
            form.addEventListener('submit', function() {
                const submitBtn = this.querySelector('button[type="submit"]');
                if (submitBtn) {
                    submitBtn.disabled = true;
                    submitBtn.innerHTML = '<i class="bi bi-hourglass-split me-2"></i>–ü—É–±–ª–∏–∫—É–µ–º...';
                }
            });
        }

        // –ê–≤—Ç–æ—Ñ–æ–∫—É—Å –Ω–∞ –ø–æ–ª–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞
        if (titleInput) {
            titleInput.focus();
        }
    });
</script>
{% endblock %}